
#user  nobody;
worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;

server {
  listen          80;
  server_name     localhost;



	# www-root, we're serving static files from here, accessible via https://localhost/
        location / {
            root  /var/www;
            index index.html index.htm;
        }

	# Our endpoint for tomcat reverse-proxy, assuming your endpoint java-servlet knows
	# how to handle http://localhost/gadgets  requests
        location /dashboard {
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header Host $http_host;
	    proxy_set_header X-Forwarded-Proto https;
            proxy_redirect off;
            proxy_connect_timeout      240;
            proxy_send_timeout         240;
            proxy_read_timeout         240;
            # note, there is not SSL here! plain HTTP is used
	   proxy_pass http://dashboard:8080/daobs;
        }

        ProxyPass /app/kibana http://kibana:5601/app/kibana
        ProxyPassReverse /app/kibana http://kibana:5601/app/kibana

        ProxyPass /bundles http://kibana:5601/bundles
        ProxyPassReverse /bundles http://kibana:5601/bundles

        ProxyPass /elasticsearch/ http://elasticsearch:9200
        ProxyPassReverse /elasticsearch/ http://elasticsearch:9200

        ProxyPass /status http://kibana:5601/status
        ProxyPassReverse /status http://kibana:/status

        ProxyPass /api/status http://kibana:5601/api/status
        ProxyPassReverse /api/status http://kibana:5601/api/status

        ProxyPass /api/console http://kibana:5601/api/console
        ProxyPassReverse /api/console http://kibana:5601/api/console

        ProxyPass /plugins/kibana/ http://kibana:5601/plugins/kibana/
        ProxyPassReverse /plugins/kibana/ http://kibana:5601/plugins/kibana/

        ProxyPass /plugins/timelion/ http://kibana:5601/plugins/timelion/
        ProxyPassReverse /plugins/timelion/ http://kibana:5601/plugins/timelion/

        ProxyPass /app/sense http://kibana:5601/app/sense
        ProxyPassReverse /app/sense http://kibana:5601/app/sense

        ProxyPass /ui/fonts/open_sans/ http://kibana:5601/ui/fonts/open_sans/
        ProxyPassReverse /ui/fonts/open_sans/ http://kibana:5601/ui/fonts/open_sans/

        ProxyPass /es_admin/ http://kibana:5601/es_admin/
        ProxyPassReverse /es_admin/ http://kibana:5601/es_admin/

    }
}

